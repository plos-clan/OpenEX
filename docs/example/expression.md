# 表达式

在 `RustEdition` 版本中, OpenEX 采用 `pratt` 表达式解析器(替换了原有的中转后缀表达式解析器),
并增加了编译期类型推断与校验功能.

:::warning 注意

```js
var a = 3.14 + null;
var b = true && 1 + 1;
```

以上的组合都是非法的, 在编译期间可以被 OpenEX 检查出来

:::

## 类型

虽然 OpenEX 本身是动态类型的, 在变量声明时也无需显示指定类型. \
但是解释器内部对基元类型有明确的表示.

* `string` 字符串类型, 支持加法运算进行拼接
* `number` 有符号整数类型, 相当于 `int64_t` `i64`
* `float` 双精浮点类型, 相当于 `double` `f64`
* `null` 空类型
* `bool` 布尔类型, 只有 `true` `false` 两种值
* `unknown` 未知类型.

> 编译器无法明确推断出一个函数的返回值或变量的类型会采用 `unknown` 类型进行标记. \
> 此时, 编译器不再对 `unknown` 类型进行编译期类型检查

## 算术运算

> 在 `number` 与 `float` 类型混合运算中, 最终的产生的计算结果类型为 `float`

| 运算符  | 类型    | 运算类型                   | 描述   |
|:----:|:------|:-----------------------|:-----|
| `+`  | 双目运算符 | `str` `number` `float` | 加法运算 |
| `-`  | 双目运算符 | `number` `float`       | 减法运算 |
| `*`  | 双目运算符 | `number` `float`       | 乘法运算 |
| `/`  | 双目运算符 | `number` `float`       | 除法运算 |
| `%`  | 双目运算符 | `number` `float`       | 取余运算 |
| `++` | 单目运算符 | `number` `float`       | 自增运算 |
| `--` | 单目运算符 | `number` `float`       | 自减运算 |

## 警告

`RustEdition` 新增加的编译期警告功能, 会对一些无作用的表达式发出警告信息.

```js
1 + 1 == 2;
this.func_1() + 4;
true && false;
```

以上都是无作用表达式, 编译器会对此类表达式发出警告.

> 可以通过 `--allow=unused-expression` 命令行参数关闭该警告
